1                                                          The SAS System                              09:20 Saturday, March 1, 2025

NOTE: Copyright (c) 2023 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.4 (TS1M8) 
      Licensed to MEDICAL COLLEGE OF WISCONSIN - T&R SFA, Site 70183647.
NOTE: This session is executing on the Linux 3.10.0-514.10.2.el7.x86_64 (LIN X64) platform.



NOTE: Analytical products:
      
      SAS/STAT 15.3
      SAS/ETS 15.3
      SAS/OR 15.3
      SAS/IML 15.3
      SAS/QC 15.3

NOTE: Additional host information:

 Linux LIN X64 3.10.0-514.10.2.el7.x86_64 #1 SMP Fri Mar 3 00:04:05 UTC 2017 x86_64 CentOS Linux release 7.6.1810 (Core)  

NOTE: SAS initialization used:
      real time           0.12 seconds
      cpu time            0.03 seconds
      

NOTE: AUTOEXEC processing beginning; file is /home/rsparapa/git/CTSI/BERD/autoexec.sas.

NOTE: Libref CRDW was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /data/shared/AI/libname/crdw
NOTE: You have called the macro _IFELSE, 2008-07-15.
NOTE: Copyright (c) 2006-2008 Rodney Sparapani
 
NOTE: You have called the macro _EXIST, 2012-07-11.
NOTE: Copyright (c) 2001-2012 Rodney Sparapani
 
NOTE: You have called the macro _FN, 2024-08-03.
NOTE: Copyright (c) 2001-2024 Rodney Sparapani
 
MPRINT(_FN):   filename fn "/home/rsparapa/git/CTSI/BERD/snippet7.sas";
MPRINT(_FN):   filename fn;
NOTE: Fileref FN has been deassigned.
NOTE: You have called the macro _TAIL, 2004-03-30.
NOTE: Copyright (c) 2001-2004 Rodney Sparapani
 
NOTE: You have called the macro _DIRCHAR, 2007-07-24.
NOTE: Copyright (c) 2004-2007 Rodney Sparapani
 
NOTE: You have called the macro _UNWIND, 2004-11-23.
NOTE: Copyright (c) 2001-2004 Rodney Sparapani
 
NOTE: You have called the macro _COUNT, 2022-06-07.
NOTE: Copyright (c) 2001-2022 Rodney Sparapani
2                              The SAS System  09:20 Saturday, March 1, 2025

 
NOTE: You have called the macro _SUBSTR, 2004-03-29.
NOTE: Copyright (c) 2001-2004 Rodney Sparapani
 
NOTE: You have called the macro _HEAD, 2004-03-30.
NOTE: Copyright (c) 2001-2004 Rodney Sparapani
 
FN=snippet7.sas
FNROOT=snippet7
FNPATH=/home/rsparapa/git/CTSI/BERD/snippet7.sas
FNDIR=/home/rsparapa/git/CTSI/BERD/
FNTEXT=snippet7.txt
FNHTML=snippet7.html
FNTEX=snippet7.tex
FNPDF=snippet7.pdf
NOTE: You have called the macro _LJ, 2004-03-30.
NOTE: Copyright (c) 2001-2004 Rodney Sparapani
 
NOTE: You have called the macro _PAD, 2004-03-30.
NOTE: Copyright (c) 2001-2004 Rodney Sparapani
 
MPRINT(_LJ):   "/home/rsparapa/git/CTSI/BERD/snippet7.sas"
MPRINT(_PAD):   
"202020202020202020202020202020202020202020202020202020202020202020202020202
0202020202020202020202020202020202020202020202020202020202020202020202020202
02020202020"X
 
*** SGANNO macros are now available ***
     NOTE: SGANNO macros (except SGANNO_HELP) should be used within data 
step.
 
 
 Following macros are available 
 
     %SGANNO_HELP 
     %SGARROW 
     %SGIMAGE 
     %SGLINE 
     %SGOVAL 
     %SGPOLYCONT 
     %SGPOLYGON 
     %SGPOLYLINE 
     %SGRECTANGLE 
     %SGTEXT 
     %SGTEXTCONT 
 
 Enter %SGANNO_HELP(macroname) for details on each SGANNO macro,
    or %SGANNO_HELP(ALL) for details on all SGANNO macros.
 
MPRINT(SGANNO):  ;
 
*** ANNOTATE macros are now available ***
3                              The SAS System  09:20 Saturday, March 1, 2025

 
 For further information on ANNOTATE macros, enter,
    %HELPANO(macroname), (for specific macros)
    %HELPANO(ALL), (for information on all macros)
 or %HELPANO (for a list of macro names)
 
NOTE: Libref CWD was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /home/rsparapa/git/CTSI/BERD
NOTE: Libref PWD refers to the same physical library as CWD.
NOTE: Libref PWD was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /home/rsparapa/git/CTSI/BERD

NOTE: AUTOEXEC processing completed.

1          
2          %_dblib(data=db.fh_hb_diagnosis_jupyter, var=_none_);
NOTE: You have called the macro _DBLIB, 2025-02-28.
NOTE: Copyright (c) 2025 Rodney Sparapani
 
NOTE: You have called the macro _REQUIRE, 2004-03-29.
NOTE: Copyright (c) 2001-2004 Rodney Sparapani
 
MPRINT(_DBLIB):  ;
NOTE: You have called the macro _LIB, 2007-08-01.
NOTE: Copyright (c) 2001-2007 Rodney Sparapani
 
NOTE: You have called the macro _DATA, 2007-07-31.
NOTE: Copyright (c) 2001-2007 Rodney Sparapani
 
MPRINT(_DBLIB):   proc sql;
MPRINT(_DBLIB):   connect to postgres as crdw (user=rsparapani 
password=&password server="garth.ctsi.mcw.edu" 
database="fh_jupyter_hub_hbdb");
MPRINT(_DBLIB):   create table schema as select * from connection to crdw 
(select * from information_schema.columns where table_schema = 'public') 
where table_name="fh_hb_diagnosis_jupyter";
NOTE: Table WORK.SCHEMA created, with 16 rows and 44 columns.

MPRINT(_DBLIB):   disconnect from crdw;
MPRINT(_DBLIB):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.22 seconds
      cpu time            0.09 seconds
      

MPRINT(_DBLIB):   data dbdates;
MPRINT(_DBLIB):   set schema;
MPRINT(_DBLIB):   where data_type=:'time';
MPRINT(_DBLIB):   run;

4                              The SAS System  09:20 Saturday, March 1, 2025

NOTE: There were 1 observations read from the data set WORK.SCHEMA.
      WHERE data_type=:'time';
NOTE: The data set WORK.DBDATES has 1 observations and 44 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

NOTE: You have called the macro _LEVEL, 2011-09-01.
NOTE: Copyright (c) 2002-2011 Rodney Sparapani
 
NOTE: You have called the macro _NOBS, 2007-07-11.
NOTE: Copyright (c) 2001-2007 Rodney Sparapani
 
NOTE: You have called the macro _DSEXIST, 2007-08-01.
NOTE: Copyright (c) 2001-2007 Rodney Sparapani
 
NOTE: You have called the macro _SUFFIX, 2004-10-26.
NOTE: Copyright (c) 2001-2004 Rodney Sparapani
 
NOTE: You have called the macro _VERSION, 2006-02-15.
NOTE: Copyright (c) 2001-2006 Rodney Sparapani
 
NOTE: You have called the macro _DIR, 2004-11-23.
NOTE: Copyright (c) 2004 Rodney Sparapani
 
NOTE: You have called the macro _FILE, 2004-11-23.
NOTE: Copyright (c) 2004 Rodney Sparapani
 
NOTE: You have called the macro _OPTION, 2004-03-29.
NOTE: Copyright (c) 2001-2004 Rodney Sparapani
 
MPRINT(_DBLIB):   data dblen;
MPRINT(_DBLIB):   set schema;
MPRINT(_DBLIB):   where data_type in:('character', 'text');
MPRINT(_DBLIB):   column_name=lowcase(column_name);
MPRINT(_DBLIB):   run;

NOTE: There were 15 observations read from the data set WORK.SCHEMA.
      WHERE data_type in: ('character', 'text');
NOTE: The data set WORK.DBLEN has 15 observations and 44 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(_DBLIB):   data patient_hash;
MPRINT(_DBLIB):   len=16;
MPRINT(_DBLIB):   output;
MPRINT(_DBLIB):   run;

NOTE: The data set WORK.PATIENT_HASH has 1 observations and 1 variables.
5                              The SAS System  09:20 Saturday, March 1, 2025

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(_DBLIB):   data encounter_hash;
MPRINT(_DBLIB):   len=16;
MPRINT(_DBLIB):   output;
MPRINT(_DBLIB):   run;

NOTE: The data set WORK.ENCOUNTER_HASH has 1 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(_DBLIB):   data enc_type;
MPRINT(_DBLIB):   len=16;
MPRINT(_DBLIB):   output;
MPRINT(_DBLIB):   run;

NOTE: The data set WORK.ENC_TYPE has 1 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(_DBLIB):   data provider_id;
MPRINT(_DBLIB):   len=16;
MPRINT(_DBLIB):   output;
MPRINT(_DBLIB):   run;

NOTE: The data set WORK.PROVIDER_ID has 1 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(_DBLIB):   data provider_name;
MPRINT(_DBLIB):   len=16;
MPRINT(_DBLIB):   output;
MPRINT(_DBLIB):   run;

NOTE: The data set WORK.PROVIDER_NAME has 1 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(_DBLIB):   data provider_title;
MPRINT(_DBLIB):   len=16;
MPRINT(_DBLIB):   output;
6                              The SAS System  09:20 Saturday, March 1, 2025

MPRINT(_DBLIB):   run;

NOTE: The data set WORK.PROVIDER_TITLE has 1 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(_DBLIB):   data dx_name;
MPRINT(_DBLIB):   len=16;
MPRINT(_DBLIB):   output;
MPRINT(_DBLIB):   run;

NOTE: The data set WORK.DX_NAME has 1 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(_DBLIB):   data dx_code;
MPRINT(_DBLIB):   len=16;
MPRINT(_DBLIB):   output;
MPRINT(_DBLIB):   run;

NOTE: The data set WORK.DX_CODE has 1 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(_DBLIB):   data dx_type;
MPRINT(_DBLIB):   len=16;
MPRINT(_DBLIB):   output;
MPRINT(_DBLIB):   run;

NOTE: The data set WORK.DX_TYPE has 1 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(_DBLIB):   data dx_source;
MPRINT(_DBLIB):   len=16;
MPRINT(_DBLIB):   output;
MPRINT(_DBLIB):   run;

NOTE: The data set WORK.DX_SOURCE has 1 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

7                              The SAS System  09:20 Saturday, March 1, 2025

MPRINT(_DBLIB):   data dx_origin;
MPRINT(_DBLIB):   len=16;
MPRINT(_DBLIB):   output;
MPRINT(_DBLIB):   run;

NOTE: The data set WORK.DX_ORIGIN has 1 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(_DBLIB):   data pdx;
MPRINT(_DBLIB):   len=16;
MPRINT(_DBLIB):   output;
MPRINT(_DBLIB):   run;

NOTE: The data set WORK.PDX has 1 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(_DBLIB):   data dx_poa;
MPRINT(_DBLIB):   len=16;
MPRINT(_DBLIB):   output;
MPRINT(_DBLIB):   run;

NOTE: The data set WORK.DX_POA has 1 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(_DBLIB):   data raw_pdx;
MPRINT(_DBLIB):   len=16;
MPRINT(_DBLIB):   output;
MPRINT(_DBLIB):   run;

NOTE: The data set WORK.RAW_PDX has 1 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(_DBLIB):   data sourcesystem_cd;
MPRINT(_DBLIB):   len=16;
MPRINT(_DBLIB):   output;
MPRINT(_DBLIB):   run;

NOTE: The data set WORK.SOURCESYSTEM_CD has 1 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
8                              The SAS System  09:20 Saturday, March 1, 2025

      cpu time            0.00 seconds
      

MPRINT(_DBLIB):   proc sql;
MPRINT(_DBLIB):   connect to postgres as crdw (user=rsparapani 
password=&password server="garth.ctsi.mcw.edu" 
database="fh_jupyter_hub_hbdb");
MPRINT(_DBLIB):   disconnect from crdw;
MPRINT(_DBLIB):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(_DBLIB):   data _null_;
MPRINT(_DBLIB):   set patient_hash encounter_hash enc_type provider_id 
provider_name provider_title dx_name dx_code dx_type dx_source dx_origin 
pdx dx_poa raw_pdx sourcesystem_cd end=last;
MPRINT(_DBLIB):   retain dbmax_text 16;
MPRINT(_DBLIB):   dbmax_text=max(dbmax_text, len);
MPRINT(_DBLIB):   if last then call symput("dbmax_text", trim(dbmax_text));
MPRINT(_DBLIB):   run;

NOTE: Numeric values have been converted to character 
      values at the places given by: (Line):(Column).
      2:191   
NOTE: There were 1 observations read from the data set WORK.PATIENT_HASH.
NOTE: There were 1 observations read from the data set WORK.ENCOUNTER_HASH.
NOTE: There were 1 observations read from the data set WORK.ENC_TYPE.
NOTE: There were 1 observations read from the data set WORK.PROVIDER_ID.
NOTE: There were 1 observations read from the data set WORK.PROVIDER_NAME.
NOTE: There were 1 observations read from the data set WORK.PROVIDER_TITLE.
NOTE: There were 1 observations read from the data set WORK.DX_NAME.
NOTE: There were 1 observations read from the data set WORK.DX_CODE.
NOTE: There were 1 observations read from the data set WORK.DX_TYPE.
NOTE: There were 1 observations read from the data set WORK.DX_SOURCE.
NOTE: There were 1 observations read from the data set WORK.DX_ORIGIN.
NOTE: There were 1 observations read from the data set WORK.PDX.
NOTE: There were 1 observations read from the data set WORK.DX_POA.
NOTE: There were 1 observations read from the data set WORK.RAW_PDX.
NOTE: There were 1 observations read from the data set WORK.SOURCESYSTEM_CD.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(_DBLIB):   libname db postgres user = "rsparapani" password = 
"&password" server = "garth.ctsi.mcw.edu" database = 
"fh_jupyter_hub_hbdb" client_encoding = "utf-8" dbmax_text = 16 
sql_functions = all port=5432 ;
NOTE: Libref DB was successfully assigned as follows: 
      Engine:        POSTGRES 
9                              The SAS System  09:20 Saturday, March 1, 2025

      Physical Name: garth.ctsi.mcw.edu
3          
4          data afib;
5              set db.&dbdata(keep=patient_hash dx_date_shifted dx_type
5        ! dx_code
6                  dx_origin enc_type pdx);
7              where
7        ! '01JAN2017:00:00:00'dt<=dx_date_shifted<'01JAN2023:00:00:00'dt &
8                  dx_code=:'I48';
9          run;

NOTE: There were 2462383 observations read from the data set 
      DB.FH_HB_DIAGNOSIS_JUPYTER.
      WHERE (dx_date_shifted>='  01JAN2017:00:00:00'DT and 
      dx_date_shifted<'  01JAN2023:00:00:00'DT) and (dx_code=:'I48');
NOTE: The data set WORK.AFIB has 2462383 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           7:05:02.38
      cpu time            4:32:55.70
      

10         
11         %_sort(data=afib, out=afib, by=patient_hash dx_date_shifted);
NOTE: You have called the macro _SORT, 2016-11-16
NOTE: Copyright (c) 2001-2016 Rodney Sparapani
 
MPRINT(_SORT):  ;
MPRINT(_SORT):   proc sort out=work.afib (sortedby=patient_hash 
dx_date_shifted) data=
MPRINT(_SORT):   work.afib (
MPRINT(_SORT):   );
NOTE: You have called the macro _BY, 2005-03-25.
NOTE: Copyright (c) 2001-2005 Rodney Sparapani
 
MPRINT(_SORT):   by
NOTE: You have called the macro _LIST, 2013-09-04.
NOTE: Copyright (c) 2001-2013 Rodney Sparapani
 
MPRINT(_BY):   PATIENT_HASH DX_DATE_SHIFTED
MPRINT(_SORT):  ;
MPRINT(_SORT):   run;

NOTE: There were 2462383 observations read from the data set WORK.AFIB.
NOTE: The data set WORK.AFIB has 2462383 observations and 7 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           2:17:17.62
      cpu time            40:23.78
      

12         
13         %_dbdata(out=crdw.snippet7);
NOTE: You have called the macro _DBDATA, 2025-02-20.
10                             The SAS System  09:20 Saturday, March 1, 2025

NOTE: Copyright (c) 2025 Rodney Sparapani
 
MPRINT(_DBDATA):  ;
NOTE: You have called the macro _BLIST, 2008-03-03.
NOTE: Copyright (c) 2004-2008 Rodney Sparapani
 
MPRINT(_DBDATA):   data crdw.snippet7;
MPRINT(_DBDATA):   length
MPRINT(_DBDATA):  ;
MPRINT(_DBDATA):   set WORK.AFIB ;
MPRINT(_DBDATA):   format _numeric_;
MPRINT(_DBDATA):   informat _numeric_;
MPRINT(_DBDATA):   informat dx_date_shifted;
MPRINT(_DBDATA):   format dx_date date9. dx_date_shifted datetime19.;
MPRINT(_DBDATA):   dx_date=datepart(dx_date_shifted);
MPRINT(_DBDATA):   run;

NOTE: There were 2462383 observations read from the data set WORK.AFIB.
NOTE: The data set CRDW.SNIPPET7 has 2462383 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           3.21 seconds
      cpu time            0.82 seconds
      

14         
15         proc contents varnum;
16         run;

NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.19 seconds
      cpu time            0.04 seconds
      
NOTE: The PROCEDURE CONTENTS printed page 1.

17         

NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           9:22:24.86
      cpu time            5:13:20.89
      
