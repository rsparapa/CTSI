1                                                          The SAS System                                 14:15 Monday, May 12, 2025

NOTE: Unable to open SASUSER.REGSTRY. WORK.REGSTRY will be opened instead.
NOTE: All registry changes will be lost at the end of the session.

WARNING: Unable to copy SASUSER registry to WORK registry. Because of this, you will not see registry customizations during this 
         session.
NOTE: Unable to open SASUSER.PROFILE. WORK.PROFILE will be opened instead.
NOTE: All profile changes will be lost at the end of the session.
NOTE: Copyright (c) 2023 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.4 (TS1M8) 
      Licensed to MEDICAL COLLEGE OF WISCONSIN - T&R SFA, Site 70183647.
NOTE: This session is executing on the Linux 3.10.0-514.10.2.el7.x86_64 (LIN X64) platform.



NOTE: Analytical products:
      
      SAS/STAT 15.3
      SAS/ETS 15.3
      SAS/OR 15.3
      SAS/IML 15.3
      SAS/QC 15.3

NOTE: Additional host information:

 Linux LIN X64 3.10.0-514.10.2.el7.x86_64 #1 SMP Fri Mar 3 00:04:05 UTC 2017 x86_64 CentOS Linux release 7.9.2009 (Core) 

NOTE: SAS initialization used:
      real time           0.08 seconds
      cpu time            0.03 seconds
      

NOTE: AUTOEXEC processing beginning; file is /home/rsparapa/git/CTSI/Summer25/autoexec.sas.

NOTE: Libref CRDW was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /data/shared/04224/afib/libname/crdw
NOTE: You have called the macro _IFELSE, 2008-07-15.
NOTE: Copyright (c) 2006-2008 Rodney Sparapani
 
NOTE: You have called the macro _EXIST, 2012-07-11.
NOTE: Copyright (c) 2001-2012 Rodney Sparapani
 
NOTE: You have called the macro _FN, 2024-08-03.
NOTE: Copyright (c) 2001-2024 Rodney Sparapani
 
MPRINT(_FN):   filename fn "/home/rsparapa/git/CTSI/Summer25/snippet6.sas";
MPRINT(_FN):   filename fn;
NOTE: Fileref FN has been deassigned.
NOTE: You have called the macro _TAIL, 2004-03-30.
NOTE: Copyright (c) 2001-2004 Rodney Sparapani
 
NOTE: You have called the macro _DIRCHAR, 2007-07-24.
2                              The SAS System     14:15 Monday, May 12, 2025

NOTE: Copyright (c) 2004-2007 Rodney Sparapani
 
NOTE: You have called the macro _UNWIND, 2004-11-23.
NOTE: Copyright (c) 2001-2004 Rodney Sparapani
 
NOTE: You have called the macro _COUNT, 2022-06-07.
NOTE: Copyright (c) 2001-2022 Rodney Sparapani
 
NOTE: You have called the macro _SUBSTR, 2004-03-29.
NOTE: Copyright (c) 2001-2004 Rodney Sparapani
 
NOTE: You have called the macro _HEAD, 2004-03-30.
NOTE: Copyright (c) 2001-2004 Rodney Sparapani
 
FN=snippet6.sas
FNROOT=snippet6
FNPATH=/home/rsparapa/git/CTSI/Summer25/snippet6.sas
FNDIR=/home/rsparapa/git/CTSI/Summer25/
FNTEXT=snippet6.txt
FNHTML=snippet6.html
FNTEX=snippet6.tex
FNPDF=snippet6.pdf
NOTE: You have called the macro _LJ, 2004-03-30.
NOTE: Copyright (c) 2001-2004 Rodney Sparapani
 
NOTE: You have called the macro _PAD, 2004-03-30.
NOTE: Copyright (c) 2001-2004 Rodney Sparapani
 
MPRINT(_LJ):   "/home/rsparapa/git/CTSI/Summer25/snippet6.sas"
MPRINT(_PAD):   
"202020202020202020202020202020202020202020202020202020202020202020202020202
0202020202020202020202020202020202020202020202020202020202020202020202020202
020"X
 
*** SGANNO macros are now available ***
     NOTE: SGANNO macros (except SGANNO_HELP) should be used within data 
step.
 
 
 Following macros are available 
 
     %SGANNO_HELP 
     %SGARROW 
     %SGIMAGE 
     %SGLINE 
     %SGOVAL 
     %SGPOLYCONT 
     %SGPOLYGON 
     %SGPOLYLINE 
     %SGRECTANGLE 
     %SGTEXT 
     %SGTEXTCONT 
3                              The SAS System     14:15 Monday, May 12, 2025

 
 Enter %SGANNO_HELP(macroname) for details on each SGANNO macro,
    or %SGANNO_HELP(ALL) for details on all SGANNO macros.
 
MPRINT(SGANNO):  ;
 
*** ANNOTATE macros are now available ***
 
 For further information on ANNOTATE macros, enter,
    %HELPANO(macroname), (for specific macros)
    %HELPANO(ALL), (for information on all macros)
 or %HELPANO (for a list of macro names)
 
NOTE: Libref CWD was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /home/rsparapa/git/CTSI/Summer25
NOTE: Libref PWD refers to the same physical library as CWD.
NOTE: Libref PWD was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /home/rsparapa/git/CTSI/Summer25

NOTE: AUTOEXEC processing completed.

1          * snippet6.sas ;
2          /*
3          BEWARE: this takes 8 hours and is demanding
4          you need to submit it with TORQUE like so
5          qsas snippet6 -host cheddar
6          */
7          * generate Medi-Span nomenclature: medispan.csv;
8          %_dblib(data=db.fh_hb_mar_table_jupyter,
NOTE: You have called the macro _DBLIB, 2025-03-11.
NOTE: Copyright (c) 2025 Rodney Sparapani
 
9              var=pharm_class pharm_subclass gpi mar_route
10                 ingredient_rxcui_name);
NOTE: You have called the macro _REQUIRE, 2004-03-29.
NOTE: Copyright (c) 2001-2004 Rodney Sparapani
 
MPRINT(_DBLIB):  ;
NOTE: You have called the macro _LIB, 2007-08-01.
NOTE: Copyright (c) 2001-2007 Rodney Sparapani
 
NOTE: You have called the macro _DATA, 2007-07-31.
NOTE: Copyright (c) 2001-2007 Rodney Sparapani
 
MPRINT(_DBLIB):   proc sql;
MPRINT(_DBLIB):   connect to postgres as crdw (user=rsparapani 
password=&password server="garth.ctsi.mcw.edu" 
database="fh_jupyter_hub_hbdb");
MPRINT(_DBLIB):   create table schema as select * from connection to crdw 
(select * from information_schema.columns where table_schema = 'public') 
4                              The SAS System     14:15 Monday, May 12, 2025

where table_name="fh_hb_mar_table_jupyter";
NOTE: Table WORK.SCHEMA created, with 37 rows and 44 columns.

MPRINT(_DBLIB):   disconnect from crdw;
MPRINT(_DBLIB):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.16 seconds
      cpu time            0.07 seconds
      

MPRINT(_DBLIB):   data dbdates;
MPRINT(_DBLIB):   set schema;
MPRINT(_DBLIB):   where data_type=:"time";
MPRINT(_DBLIB):   run;

NOTE: There were 2 observations read from the data set WORK.SCHEMA.
      WHERE data_type=:'time';
NOTE: The data set WORK.DBDATES has 2 observations and 44 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: You have called the macro _LEVEL, 2011-09-01.
NOTE: Copyright (c) 2002-2011 Rodney Sparapani
 
NOTE: You have called the macro _NOBS, 2007-07-11.
NOTE: Copyright (c) 2001-2007 Rodney Sparapani
 
NOTE: You have called the macro _DSEXIST, 2007-08-01.
NOTE: Copyright (c) 2001-2007 Rodney Sparapani
 
NOTE: You have called the macro _SUFFIX, 2004-10-26.
NOTE: Copyright (c) 2001-2004 Rodney Sparapani
 
NOTE: You have called the macro _VERSION, 2006-02-15.
NOTE: Copyright (c) 2001-2006 Rodney Sparapani
 
NOTE: You have called the macro _DIR, 2004-11-23.
NOTE: Copyright (c) 2004 Rodney Sparapani
 
NOTE: You have called the macro _FILE, 2004-11-23.
NOTE: Copyright (c) 2004 Rodney Sparapani
 
NOTE: You have called the macro _OPTION, 2004-03-29.
NOTE: Copyright (c) 2001-2004 Rodney Sparapani
 
MPRINT(_DBLIB):   data dblen;
MPRINT(_DBLIB):   set schema;
MPRINT(_DBLIB):   where data_type in:('character', 'text');
MPRINT(_DBLIB):   column_name=lowcase(column_name);
MPRINT(_DBLIB):   run;
5                              The SAS System     14:15 Monday, May 12, 2025


NOTE: There were 30 observations read from the data set WORK.SCHEMA.
      WHERE data_type in: ('character', 'text');
NOTE: The data set WORK.DBLEN has 30 observations and 44 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(_DBLIB):   proc sql;
MPRINT(_DBLIB):   connect to postgres as crdw (user=rsparapani 
password=&password server="garth.ctsi.mcw.edu" 
database="fh_jupyter_hub_hbdb");
NOTE: You have called the macro _INDEXW, 2009-11-19.
NOTE: Copyright (c) 2009 Rodney Sparapani
 
MPRINT(_DBLIB):   create table length as select * from connection to crdw 
(select
MPRINT(_DBLIB):   16 as patient_hash,
MPRINT(_DBLIB):   16 as encounter_hash,
MPRINT(_DBLIB):   16 as order_med_id_hash,
MPRINT(_DBLIB):   16 as medication_name,
MPRINT(_DBLIB):   16 as mar_action,
MPRINT(_DBLIB):   16 as mar_dose,
MPRINT(_DBLIB):   16 as mar_dose_unit,
MPRINT(_DBLIB):   max(length(mar_route)) as mar_route,
MPRINT(_DBLIB):   max(length(pharm_class)) as pharm_class,
MPRINT(_DBLIB):   max(length(pharm_subclass)) as pharm_subclass,
MPRINT(_DBLIB):   16 as ingredient_rxcui,
MPRINT(_DBLIB):   max(length(ingredient_rxcui_name)) as 
ingredient_rxcui_name,
MPRINT(_DBLIB):   16 as specific_rxcui,
MPRINT(_DBLIB):   16 as specific_rxcui_type,
MPRINT(_DBLIB):   max(length(gpi)) as gpi,
MPRINT(_DBLIB):   16 as order_class,
MPRINT(_DBLIB):   16 as ordering_mode,
MPRINT(_DBLIB):   16 as order_status,
MPRINT(_DBLIB):   16 as freq_id,
MPRINT(_DBLIB):   16 as frequency,
MPRINT(_DBLIB):   16 as order_dose,
MPRINT(_DBLIB):   16 as order_dose_unit,
MPRINT(_DBLIB):   16 as quantity,
MPRINT(_DBLIB):   16 as part_of_mix_yn,
MPRINT(_DBLIB):   16 as mix_ingredient_type,
MPRINT(_DBLIB):   16 as mix_parent_medication_name,
MPRINT(_DBLIB):   16 as auth_prov_id,
MPRINT(_DBLIB):   16 as auth_provider,
MPRINT(_DBLIB):   16 as auth_provider_type,
MPRINT(_DBLIB):   16 as auth_prov_title from fh_hb_mar_table_jupyter);
NOTE: Table WORK.LENGTH created, with 1 rows and 30 columns.

MPRINT(_DBLIB):   disconnect from crdw;
6                              The SAS System     14:15 Monday, May 12, 2025

MPRINT(_DBLIB):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           48.57 seconds
      cpu time            0.02 seconds
      

MPRINT(_DBLIB):   data _null_;
MPRINT(_DBLIB):   set length;
MPRINT(_DBLIB):   call symput("dbmax_text", trim(max(of 
patient_hash--auth_prov_title)));
MPRINT(_DBLIB):   call symput("len1", trim(patient_hash));
MPRINT(_DBLIB):   call symput("len2", trim(encounter_hash));
MPRINT(_DBLIB):   call symput("len3", trim(order_med_id_hash));
MPRINT(_DBLIB):   call symput("len4", trim(medication_name));
MPRINT(_DBLIB):   call symput("len5", trim(mar_action));
MPRINT(_DBLIB):   call symput("len6", trim(mar_dose));
MPRINT(_DBLIB):   call symput("len7", trim(mar_dose_unit));
MPRINT(_DBLIB):   call symput("len8", trim(mar_route));
MPRINT(_DBLIB):   call symput("len9", trim(pharm_class));
MPRINT(_DBLIB):   call symput("len10", trim(pharm_subclass));
MPRINT(_DBLIB):   call symput("len11", trim(ingredient_rxcui));
MPRINT(_DBLIB):   call symput("len12", trim(ingredient_rxcui_name));
MPRINT(_DBLIB):   call symput("len13", trim(specific_rxcui));
MPRINT(_DBLIB):   call symput("len14", trim(specific_rxcui_type));
MPRINT(_DBLIB):   call symput("len15", trim(gpi));
MPRINT(_DBLIB):   call symput("len16", trim(order_class));
MPRINT(_DBLIB):   call symput("len17", trim(ordering_mode));
MPRINT(_DBLIB):   call symput("len18", trim(order_status));
MPRINT(_DBLIB):   call symput("len19", trim(freq_id));
MPRINT(_DBLIB):   call symput("len20", trim(frequency));
MPRINT(_DBLIB):   call symput("len21", trim(order_dose));
MPRINT(_DBLIB):   call symput("len22", trim(order_dose_unit));
MPRINT(_DBLIB):   call symput("len23", trim(quantity));
MPRINT(_DBLIB):   call symput("len24", trim(part_of_mix_yn));
MPRINT(_DBLIB):   call symput("len25", trim(mix_ingredient_type));
MPRINT(_DBLIB):   call symput("len26", trim(mix_parent_medication_name));
MPRINT(_DBLIB):   call symput("len27", trim(auth_prov_id));
MPRINT(_DBLIB):   call symput("len28", trim(auth_provider));
MPRINT(_DBLIB):   call symput("len29", trim(auth_provider_type));
MPRINT(_DBLIB):   call symput("len30", trim(auth_prov_title));
MPRINT(_DBLIB):   run;

NOTE: Numeric values have been converted to character 
      values at the places given by: (Line):(Column).
      10:33   10:1    10:1    10:1    10:1    10:1    10:1    10:1
      10:1    10:1    10:1    10:1    10:1    10:1    10:1    10:1
      10:1    10:1    10:1    10:1    10:1    10:1    10:1    10:1
      10:1    10:1    10:1    10:1    10:1    10:1    10:1    
NOTE: There were 1 observations read from the data set WORK.LENGTH.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
7                              The SAS System     14:15 Monday, May 12, 2025

      

MPRINT(_DBLIB):   libname db postgres user = "rsparapani" password = 
"&password" server = "garth.ctsi.mcw.edu" database = 
"fh_jupyter_hub_hbdb" client_encoding = "utf-8" dbmax_text = 106 
sql_functions = all port=5432 ;
NOTE: Libref DB was successfully assigned as follows: 
      Engine:        POSTGRES 
      Physical Name: garth.ctsi.mcw.edu
11         
12         data mar_table;
13             set db.&dbdata(keep=pharm_class pharm_subclass gpi
14                 mar_route ingredient_rxcui_name);
15             where gpi>"" &
16                 ingredient_rxcui_name^="No ingredient mapped";
17         run;
